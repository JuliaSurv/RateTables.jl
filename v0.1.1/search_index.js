var documenterSearchIndex = {"docs":
[{"location":"","page":"Home","title":"Home","text":"CurrentModule = RateTables","category":"page"},{"location":"#RateTables","page":"Home","title":"RateTables","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The RateTables.jl Julia package provides daily rate table objects extracted from census datasets, tailored for person-year computations. This functionality is similar to R's ratetable class. ","category":"page"},{"location":"","page":"Home","title":"Home","text":"You can install it using the command below: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(\"https://github.com/JuliaSurv/RateTables.jl\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"Loading this package exports constant RateTable objects. The index refering to all the available rate tables can be found at the bottom of this page. For the sake of this example, we'll use the hmd_rates dictionary which stores rates tables extracted from the Human Mortality Database (HMD).","category":"page"},{"location":"","page":"Home","title":"Home","text":"using RateTables\nhmd_rates","category":"page"},{"location":"","page":"Home","title":"Home","text":"The output of the REPL shows that we have a RateTable object with two covariates :country and :sex. You can query the available covariates of a given RateTable as such: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"availlable_covariates(hmd_rates, :sex)","category":"page"},{"location":"","page":"Home","title":"Home","text":"For this specific dataset, the number of countries is huge and calling availlable_covariates(hmd_rates, :country) won't be very useful. Thus, for convenience, we provided details on the country codes separately in another constant object called hmd_countries:","category":"page"},{"location":"","page":"Home","title":"Home","text":"hmd_countries","category":"page"},{"location":"","page":"Home","title":"Home","text":"Recall that the daily hazard rate of mortality is defined as -log(1 - q_x)365241 for an annual death rate q_x. We present an alternative approach to displaying mortality tables that is particularly convenient for person-year computations. To obtain daily rates from the tables, you can use the daily_hazard function. Its arguments need to be in the following specific format: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"The age parameter should be provided in days, with the conversion factor being 1 year = 365.241 days.\nThe date parameter should be provided in days as well, with the same conversion factor. \nThe format of other covariates may vary between rate tables, but it's essential to consider that their order is significant.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The sex covariate typically has values such as :male and :female, and sometimes :total. For the hmd_rates table, we have previously observed two additional covariates: country and sex. ","category":"page"},{"location":"","page":"Home","title":"Home","text":"Depending on the querying syntax, the order of the passed arguments can be significant. For instance, the daily hazard rate for a Slovene male, on his 20th birthday, which happens to fall on the first of january 2010, can be queried using one of the following syntaxes:  ","category":"page"},{"location":"","page":"Home","title":"Home","text":"c = :svn # slovenia. \na = 20*365.241\nd = 2010*365.241\ns = :male\nv1 = daily_hazard(hmd_rates, a, d, c, s)\nv2 = daily_hazard(hmd_rates, a, d; country=c, sex=s)\nv3 = daily_hazard(hmd_rates, a, d; sex=s, country=c) # when using kwargs syntax, the order of additional covariates does not matter. \nv4 = daily_hazard(hmd_rates[c, s], a, d) # here, the order of the arguments (c,s) matters. \n(v1,v2,v3,v4)","category":"page"},{"location":"","page":"Home","title":"Home","text":"For completeness, this package also includes datasets commonly used in R for census data, particularly, the relsurv::slopop dataset pertaining to Slovenia: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"daily_hazard(slopop, a, d; sex=s)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Note the discrepency with the HMD data. ","category":"page"},{"location":"","page":"Home","title":"Home","text":"Another example with additional covariates would be the survival::survexp.usr dataset which includes race as a covariate. In this case, the calling structure remains similar: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"r = :white\nv1 = daily_hazard(survexp_usr, a, d, s, r)\nv2 = daily_hazard(survexp_usr, a, d; sex=s, race=r)\nv3 = daily_hazard(survexp_usr, a, d; race=r, sex=s)\nv4 = daily_hazard(survexp_usr[s, r], a, d)\n(v1,v2,v3,v4)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Please note that retrieving these daily hazards is a highly sensitive operation that should be optimized for speed, especially considering it's often used within critical loops. As such, we prioritize the performance of our fetching algorithms.","category":"page"},{"location":"","page":"Home","title":"Home","text":"For a list of the available rate tables, kindly refer to the following index:","category":"page"},{"location":"#Life-random-variables","page":"Home","title":"Life random variables","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The Life function is used to extract individual life profiles (as random variables complient with Distributions.jl's API) from a comprehensive ratetable, by using covariates such as age, gender, and health status or others. Once these life profiles are established, they serve as foundational elements for various analytical practices such as survival probability estimations, expected lifespan calculations, and simulations involving random variables related to life expectancy. ","category":"page"},{"location":"","page":"Home","title":"Home","text":"When applying it to a male individual aged 20 in 1990, we get the outcome below: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"L = Life(slopop[:male], 7000, 1990*365.241)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Due to the constance of the hazard rates on each cell of the lifetable, the life expectation can be computed through the following formula: ","category":"page"},{"location":"","page":"Home","title":"Home","text":"$","category":"page"},{"location":"","page":"Home","title":"Home","text":"\\mathbf{E}(P) = \\int0^\\inf Sp (t) dt = \\sum{j=0}^\\inf \\frac{Sp(tj)}{\\lambdap(tj)(1 - exp(-\\lambdap(tj)(t{j+1}-t_j)))} $","category":"page"},{"location":"","page":"Home","title":"Home","text":"Implemented in the function Distributions.expectation:","category":"page"},{"location":"","page":"Home","title":"Home","text":"expectation(L)/365.241","category":"page"},{"location":"","page":"Home","title":"Home","text":"We get 577 years left, implying a total life expectancy of about 77 years for the given individual.","category":"page"},{"location":"","page":"Home","title":"Home","text":"These random variables comply with the Distributions.jl's API.","category":"page"},{"location":"#Package-contents","page":"Home","title":"Package contents","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"Modules = [RateTables]","category":"page"},{"location":"#RateTables.frpop","page":"Home","title":"RateTables.frpop","text":"`frpop`\n\nFrench census datas, sourced from the Human mortality database (not exaclty the same series as hmd_rates[:fr]). \n\nSegmented by sex ∈ (:male, :female)\n\n\n\n\n\n","category":"constant"},{"location":"#RateTables.hmd_countries","page":"Home","title":"RateTables.hmd_countries","text":"`hmd_countries`\n\nGives a list of countries codes used in the hmd_rates dataset. \n\n\n\n\n\n","category":"constant"},{"location":"#RateTables.hmd_rates","page":"Home","title":"RateTables.hmd_rates","text":"`hmd_rates`\n\nRateTable providing daily hazard rates for both sexes for several countries. They are derived from annual death probabilities (qₓ's) from the Human Mortality Database\n\nSegmented by country ∈ keys(hmd_countries) and sex ∈ (:male, :female, :total). \n\nThe list of countries codes is given with details in the hmd_countries constant. \n\n\n\n\n\n","category":"constant"},{"location":"#RateTables.slopop","page":"Home","title":"RateTables.slopop","text":"`slopop`\n\nSlovene census data. Correspond to R's relsurv::slopop ratetable from the relsurv package. Segmented by sex ∈ (:male, :female).\n\n\n\n\n\n","category":"constant"},{"location":"#RateTables.survexp_fr","page":"Home","title":"RateTables.survexp_fr","text":"`survexp_fr`\n\nFrench census datas, drawn from R's package survexp.fr. Death rates are available from 1977 to 2019 for males and females aged from 0 to 99. Segmented by sex ∈ (:male, :female)\n\nSource: https://www.insee.fr/fr/statistiques/fichier/5390366/fm_t68.xlsx\n\nReferences: Institut National de la Statistique et des Etudes Economiques\n\n\n\n\n\n","category":"constant"},{"location":"#RateTables.survexp_mn","page":"Home","title":"RateTables.survexp_mn","text":"`survexp_mn`\n\nCensus data set for the US population, drawn from R's package survival. RateTable survexp_mn gives total Minnesota population, by age and sex, 1970 to 2013. Segmented by sex ∈ (:male, :female)\n\n\n\n\n\n","category":"constant"},{"location":"#RateTables.survexp_us","page":"Home","title":"RateTables.survexp_us","text":"`survexp_us`\n\nCensus data set for the US population, drawn from R's package survival. RateTable survexp_us gives total United States population, by age and sex, 1940 to 2012. Segmented by sex ∈ (:male, :female)\n\n\n\n\n\n","category":"constant"},{"location":"#RateTables.survexp_usr","page":"Home","title":"RateTables.survexp_usr","text":"`survexp_usr`\n\nCensus data set for the US population, drawn from R's package survival. RateTable survexp_usr gives the United States population, by age, sex and race, 1940 to 2014. Race is white or black. For 1960 and 1970 the black population values were not reported separately, so the nonwhite values were used. (Over the years, the reported tables have differed wrt reporting non-white and/or black.). Segmented by sex ∈ (:male, :female) and race∈ (:white, :black)`. \n\n\n\n\n\n","category":"constant"},{"location":"#RateTables.Life","page":"Home","title":"RateTables.Life","text":"Life(brt::BasicRateTable,a,d)\n\nThis function returns a random variable that correspond to an extracted Life from the BasicRateTable at age a and date d. \n\nThis works by checking if the individual is closer to the oldest age than the last year in the ratetable, calculating at each step the time difference and the hazard values. For the younger individuals, we assume they go through the last column at the end no matter what age they are. \n\n\n\n\n\n","category":"type"},{"location":"#RateTables.RateTable","page":"Home","title":"RateTables.RateTable","text":"`RateTable`\n\nThis class contains daily rate tables used in person-years computation. \n\nEach of these tables contains the daily hazard rate for a matched subject from the population, defined as -log(1-qₓ) for qₓ the 1 year probability of death as reported in the original tables from the US Census. The tables are given in terms of hazard per day for computational convenience.\n\n\n\n\n\n","category":"type"},{"location":"#RateTables.cumhazard-Tuple{Life, Real}","page":"Home","title":"RateTables.cumhazard","text":"cumhazard\n\nAssuming the last box is infinitely wide, we calculate the cumulative hazard from ∂t and λ taken from the Life function.\n\n\n\n\n\n","category":"method"},{"location":"#RateTables.daily_hazard-Tuple{RateTables.BasicRateTable, Any, Any}","page":"Home","title":"RateTables.daily_hazard","text":"`daily_hazard(rt::BasicRateTable,age,date)`\n\nThis function queries daily hazard values from a given BasicRateTable. The parameters age and date have to be in days (1 year = 365.241 days).\n\n\n\n\n\n","category":"method"}]
}
